"use strict";var __importDefault=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.init=void 0;const fs_1=__importDefault(require("fs")),path_1=__importDefault(require("path")),utils_1=require("./utils"),uuid_1=require("uuid"),env_1=__importDefault(require("../../../config/env"));function initProjectInfo(t,e){return Object.keys(t).reduce((i,o)=>{if(fs_1.default.existsSync(o)){const s=(0,utils_1.getPathId)(o),n=path_1.default.join(e,"builds",s);i.projects[o]=Object.assign({tmpConfig:(0,utils_1.getTmpConfig)(n),compilePath:o,compileId:s,appData:{}},t[o]),i.projectIds[s]=o}return i},{projects:{},projectIds:{}})}function init(t){const e=t.get("accountInfo"),i=t.get("accountInfoMap"),o=t.get("ideConfig"),s=t.get("cookies")||[],n=t.get("projects")||{},u=t.getRootPath(),r=path_1.default.join(u,"gadget-jssdk"),c=t.get("settings")||{locale:env_1.default.oversea?"en-US":"default",proxy:{type:"direct"},customHeaders:{}};let a=t.get("uuid");const g=t.get("testAccounts")||[];return a||(a=(0,uuid_1.v1)(),t.set("uuid",a)),Object.assign({accountInfo:e,accountInfoMap:i,rootPath:u,ideConfig:Object.assign({sdkRootPath:r,simulatorConfig:{}},o),cookies:s,blocks:t.get("blocks")||{},h5OfflineList:t.get("h5OfflineList")||{},h5InBlockList:t.get("h5InBlockList")||{},uuid:a,testAccounts:g,settings:c,history:t.get("history")||[],windowSizeMemory:t.get("windowSizeMemory")||{h5:{height:845,width:909},gadget:{height:845,width:909},welcome:{height:600,width:870},block:{height:845,width:909}},usersConfig:t.get("usersConfig")||{}},initProjectInfo(n,u))}exports.init=init;