import test from 'ava';
import sinon from 'sinon';
import { createClient } from '../client';
import { id, createBaseConfigManager, directBuilder } from '../utils';
test('process pre-start reports', function (t) {
    var sendFn = sinon.fake();
    var client = createClient({
        builder: directBuilder,
        createSender: function () { return ({
            send: sendFn,
        }); },
        createDefaultConfig: function () { return ({}); },
        validateInitConfig: function () { return true; },
        initConfigNormalizer: id,
        userConfigNormalizer: id,
        createConfigManager: createBaseConfigManager,
    });
    client.send({ id: 1 });
    t.assert(sendFn.notCalled);
    client.report({ id: 123 });
    t.assert(sendFn.notCalled);
    client.start();
    t.assert(sendFn.notCalled);
    client.init({});
    t.assert(sendFn.notCalled);
    client.start();
    t.assert(sendFn.calledOnce);
    t.deepEqual(sendFn.args[0][0], { id: 123 });
    client.report({ id: 456 });
    t.assert(sendFn.calledTwice);
    t.deepEqual(sendFn.args[1][0], { id: 456 });
});
//# sourceMappingURL=client.prestart.spec.js.map