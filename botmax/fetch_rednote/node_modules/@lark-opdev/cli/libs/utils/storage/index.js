"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const common_1 = require("@bdeefe/feishu-devtools-core/libs/config/common");
const storage_1 = __importDefault(require("@bdeefe/feishu-devtools-core/libs/utils/storage"));
const storageV2_1 = __importDefault(require("@bdeefe/feishu-devtools-core/libs/utils/storageV2"));
const crypto_1 = require("./crypto");
const system_1 = require("./system");
const storageUtils = (0, common_1.enableStorageV2)()
    ? new storageV2_1.default({
        cipherConfig: {
            cryptoCipherIns: new crypto_1.CryptoCipher({}),
            systemCipherIns: system_1.secretManager.available
                ? new crypto_1.CryptoCipher(system_1.secretManager.getSecret())
                : undefined,
        },
    })
    : new storage_1.default();
exports.default = storageUtils;
