!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("path"),require("fs"),require("events"),require("constants"),require("stream"),require("util"),require("assert")):"function"==typeof define&&define.amd?define(["exports","path","fs","events","constants","stream","util","assert"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).Slardar={},t.require$$0$3,t.require$$0$2,t.require$$2,t.require$$0,t.require$$0$1,t.require$$4,t.require$$5)}(this,function(t,e,n,r,o,i,c,u){"use strict";function a(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var _=a(e),b=a(n),S=a(r),e=a(o),n=a(i),r=a(c),s=a(u);function l(t){var n,r=t.transport,o=t.endpoint,e=t.size,i=void 0===e?10:e,t=t.wait,c=void 0===t?1e3:t,u=[],a=0;function s(){var e;u.length&&(e=this.getBatchData(),r.post({url:o,data:e,fail:function(t){n&&n(t,e)}}),u=[])}return{getSize:function(){return i},getWait:function(){return c},setSize:function(t){i=t},setWait:function(t){c=t},getEndpoint:function(){return o},setEndpoint:function(t){o=t},send:function(t){u.push(t),u.length>=i&&s.call(this),clearTimeout(a),a=setTimeout(s.bind(this),c)},flush:function(){clearTimeout(a),s.call(this)},getBatchData:function(){return u.length?(t=u,JSON.stringify({ev_type:"batch",list:t})):"";var t},clear:function(){clearTimeout(a),u=[]},fail:function(t){n=t}}}var f=function(){return(f=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function p(t,c,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{i(a.next(t))}catch(t){e(t)}}function o(t){try{i(a.throw(t))}catch(t){e(t)}}function i(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,o)}i((a=a.apply(t,c||[])).next())})}function d(n,r){var o,i,c,u={label:0,sent:function(){if(1&c[0])throw c[1];return c[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(c=2&e[0]?i.return:e[0]?i.throw||((c=i.return)&&c.call(i),0):i.next)&&!(c=c.call(i,e[1])).done)return c;switch(i=0,(e=c?[2&e[0],c.value]:e)[0]){case 0:case 1:c=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,i=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(c=0<(c=u.trys).length&&c[c.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!c||e[1]>c[0]&&e[1]<c[3])){u.label=e[1];break}if(6===e[0]&&u.label<c[1]){u.label=c[1],c=e;break}if(c&&u.label<c[2]){u.label=c[2],u.ops.push(e);break}c[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],i=0}finally{o=c=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function g(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),c=[];try{for(;(void 0===e||0<e--)&&!(r=i.next()).done;)c.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return c}function w(t,e,n){if(n||2===arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||((r=r||Array.prototype.slice.call(e,0,o))[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))}var E=["init","start","config","beforeDestroy","provide","beforeReport","report","beforeBuild","build","beforeSend","send","beforeConfig"],h=function(){return{}};function m(t){return t}function I(t){return"object"==typeof t&&null!==t}var y=Object.prototype;function v(t){if(I(t)){if("function"!=typeof Object.getPrototypeOf)return"[object Object]"===y.toString.call(t);t=Object.getPrototypeOf(t);return t===y||null===t}}function R(t){return"[object Array]"===y.toString.call(t)}function O(t){return"function"==typeof t}function C(t){return"number"==typeof t}function A(t){return"string"==typeof t}function x(t){switch(Object.prototype.toString.call(t)){case"[object Error]":case"[object Exception]":case"[object DOMError]":case"[object DOMException]":return 1;default:return t instanceof Error}}function D(t){return"undefined"!=typeof Event&&function(t,e){try{return t instanceof e}catch(t){return}}(t,Event)}function j(t,e){var n,r,o=f({},t);for(n in e)r=n,Object.prototype.hasOwnProperty.call(e,r)&&void 0!==e[n]&&(I(e[n])&&v(e[n])?o[n]=j(I(t[n])?t[n]:{},e[n]):R(e[n])&&R(t[n])?o[n]=function e(t,n){t=R(t)?t:[];n=R(n)?n:[];return Array.prototype.concat.call(t,n).map(function(t){return t instanceof RegExp?t:I(t)&&v(t)?j({},t):R(t)?e([],t):t})}(t[n],e[n]):o[n]=e[n]);return o}function P(t,e){if(!R(t))return!1;if(0===t.length)return!1;for(var n=0;n<t.length;){if(t[n]===e)return!0;n++}return!1}function T(t,e){if(!R(t))return t;var n=t.indexOf(e);if(0<=n){e=t.slice();return e.splice(n,1),e}return t}function N(t,e,n){for(var r,o=(e=g(e.split(".")))[0],i=e.slice(1);t&&0<i.length;)t=t[o],o=(r=g(i))[0],i=r.slice(1);if(t)return n(t,o)}var M=function(n,t){return n&&I(n)?t.reduce(function(t,e){return t[e]=n[e],t},{}):n};function L(t){return R(t)&&t.length?function(t){for(var e=[],n=t.length,r=0;r<n;r++){var o=t[r];A(o)?e.push(o.replace(/([.*+?^=!:${}()|[\]/\\])/g,"\\$1")):o&&o.source&&e.push(o.source)}return new RegExp(e.join("|"),"i")}(t):null}function k(t){try{return A(t)?t:JSON.stringify(t)}catch(t){return"[FAILED_TO_STRINGIFY]:"+String(t)}}function F(i,c,u,a){return void 0===a&&(a=!0),function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(!i)return h;var n=i[c],r=u.apply(void 0,w([n],g(t),!1)),o=r;return O(o)&&a&&(o=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return r.apply(this,e)}catch(t){return O(n)&&n.apply(this,e)}}),i[c]=o,function(t){t||(o===i[c]?i[c]=n:r=n)}}}function U(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];console.warn.apply(console,w(["[SDK]",Date.now(),(""+K++).padStart(8," ")],g(t),!1))}function q(r){return function(t){for(var e=t,n=0;n<r.length&&e;n++)try{e=r[n](e)}catch(t){z(t)}return e}}var G=0,z=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];console.error.apply(console,w(["[SDK]",Date.now(),(""+G++).padStart(8," ")],g(t),!1))},K=0,$=function(t){return Math.random()<Number(t)},B=function(t,e){return t<Number(e)};function Y(){var t=function(){for(var t=new Array(16),e=0,n=0;n<16;n++)0==(3&n)&&(e=4294967296*Math.random()),t[n]=e>>>((3&n)<<3)&255;return t}();return t[6]=15&t[6]|64,t[8]=63&t[8]|128,function(t){for(var e=[],n=0;n<256;++n)e[n]=(n+256).toString(16).substr(1);var r=0,o=e;return[o[t[r++]],o[t[r++]],o[t[r++]],o[t[r++]],"-",o[t[r++]],o[t[r++]],"-",o[t[r++]],o[t[r++]],"-",o[t[r++]],o[t[r++]],"-",o[t[r++]],o[t[r++]],o[t[r++]],o[t[r++]],o[t[+r]],o[t[15]]].join("")}(t)}var W=function(t){var n,r,o,e=(n={},r={},o={set:function(t,e){return n[t]=e,r[t]=k(e),o},merge:function(e){return n=f(f({},n),e),Object.keys(e).forEach(function(t){r[t]=k(e[t])}),o},delete:function(t){return delete n[t],delete r[t],o},clear:function(){return n={},r={},o},get:function(t){return r[t]},toString:function(){return f({},r)}});t.provide("context",e),t.on("report",function(t){return t.extra||(t.extra={}),t.extra.context=e.toString(),t})},H=function(u,a,n){function s(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t[0];if(n){var r=n.split(".")[0];if(r in s)return i=s,c=n,o=[].slice.call(t,1),N(i,c,function(t,e){if(t&&e in t&&O(t[e]))try{return t[e].apply(t,o)}catch(t){return}});var o,i=l[r]||[],c=null!==(c=null==a?void 0:a(u))&&void 0!==c?c:{};i.push(w([c],g(t),!1)),void(l[r]=i)}}var t,l={};for(t in F(u,"provide",function(n){return function(t,e){s[t]=e,n.call(u,t,e)}})(),u)Object.prototype.hasOwnProperty.call(u,t)&&(s[t]=u[t]);return u.on("provide",function(t){l[t]&&(l[t].forEach(function(t){var e=g(t),t=e[0],e=e.slice(1);null!=n&&n(u,t,e)}),l[t]=null)}),s};function J(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(t){if(t)return t.__SLARDAR_REGISTRY__||(t.__SLARDAR_REGISTRY__={Slardar:{plugins:[],errors:[],subject:{}}}),t.__SLARDAR_REGISTRY__.Slardar}(function(){if("object"==typeof window&&I(window))return window}());n&&(n.errors||(n.errors=[]),n.errors.push(t))}function V(t){return"[object ErrorEvent]"===Object.prototype.toString.call(t)?it(t):("[object PromiseRejectionEvent]"===Object.prototype.toString.call(t)?ct:ot)(t)}function Q(t,e){var n=t.common||{};return n.sample_rate=e,t.common=n,t}function X(t,e,n,r,o){return t?(i=o(r,e),function(){return i}):function(){return n(e)};var i}function Z(t,e,n,r){if(void 0===(t=N(t,e,function(t,e){return t[e]})))return!1;var o,e="boolean"==typeof t?"bool":C(t)?"number":"string";return function(t,e,n){switch(n){case"eq":return P(e,t);case"neq":return!P(e,t);case"gt":return t>e[0];case"gte":return t>=e[0];case"lt":return t<e[0];case"lte":return t<=e[0];case"regex":return Boolean(t.match(new RegExp(e.join("|"))));case"not_regex":return!t.match(new RegExp(e.join("|")));default:return!1}}(t,(o=e,r.map(function(t){switch(o){case"number":return Number(t);case"boolean":return"1"===t;default:return String(t)}})),n)}function tt(e,t){try{return"rule"===t.type?Z(e,t.field,t.op,t.values):"and"===t.type?t.children.every(function(t){return tt(e,t)}):t.children.some(function(t){return tt(e,t)})}catch(t){return J(t),!1}}var et=function(t,e,n,r){void 0===e&&(e={}),void 0===r&&(r=[]);try{var o=t.apply(void 0,w([],g(r),!1));return o&&o(e,n)||[]}catch(t){return J(t),[]}},nt=function(){return Date.now()},rt=["name","message","stack","filename","lineno","colno"],ot=function(t){var e;return x(t)?e=M(t,rt):(v(t)||D(t)||A(t))&&(e={message:k(t)}),e},it=function(t){return ot(t.error)},ct=function(t){var e;try{var n=void 0;if("reason"in t?n=t.reason:"detail"in t&&"reason"in t.detail&&(n=t.detail.reason),n){var r=ot(n);return f(f({},r),{name:null!==(e=r&&r.name)&&void 0!==e?e:"UnhandledRejection"})}}catch(t){}},ut="custom",at=function(t){if(t&&I(t)&&t.name&&A(t.name)){var e={name:t.name,type:"event"};if("metrics"in t&&I(t.metrics)){var n=t.metrics,r={};for(o in n)C(n[o])&&(r[o]=n[o]);e.metrics=r}if("categories"in t&&I(t.categories)){var o,i=t.categories,c={};for(o in i)c[o]=k(i[o]);e.categories=c}return e}},st=function(t){if(t&&I(t)&&t.content&&A(t.content)){var e={content:k(t.content),type:"log",level:"info"};if("level"in t&&(e.level=t.level),"extra"in t&&I(t.extra)){var n,r=t.extra,o={},i={};for(n in r)C(r[n])?o[n]=r[n]:i[n]=k(r[n]);e.metrics=o,e.categories=i}return e}},lt=function(t,e,n,r){if(!e)return m;var o=e.sample_rate,i=e.include_users,c=e.sample_granularity,u=e.rules,e=e.r,e=void 0===e?Math.random():e;if(P(i,t))return function(t){return Q(t,1)};var a,s,l,f,p,d,h,c="session"===c,y=X(c,o,n,e,r),v=(a=u,s=c,l=o,f=n,p=e,d=r,h={},Object.keys(a).forEach(function(t){var e=a[t],n=e.enable,r=e.sample_rate,e=e.conditional_sample_rules;n?(h[t]={enable:n,sample_rate:r,effectiveSampleRate:r*l,hit:X(s,r,f,p,d)},e&&(h[t].conditional_hit_rules=e.map(function(t){var e=t.sample_rate,t=t.filter;return{sample_rate:e,hit:X(s,e,f,p,d),effectiveSampleRate:e*l,filter:t}}))):h[t]={enable:n,hit:function(){return!1},sample_rate:0,effectiveSampleRate:0}}),h);return function(t){if(!y())return!1;if(!(t.ev_type in v))return Q(t,o);if(!v[t.ev_type].enable)return!1;if(null!==(e=t.common)&&void 0!==e&&e.sample_rate)return t;var e=v[t.ev_type],n=e.conditional_hit_rules;if(n)for(var r=0;r<n.length;r++)if(tt(t,n[r].filter))return!!n[r].hit()&&Q(t,n[r].effectiveSampleRate);return!!e.hit()&&Q(t,e.effectiveSampleRate)}},ft={build:function(t){var e;return{ev_type:t.ev_type,payload:t.payload,common:f(f({},null!==(e=t.extra)&&void 0!==e?e:{}),null!==(t=t.overrides)&&void 0!==t?t:{})}}},pt=20,dt="mon-va-useast2a.byteoversea.com",ht="/monitor_browser/collect/batch/",yt="/monitor_web/settings/browser-settings",vt=dt,mt="mon-va-useast2a.byteoversea.com",gt="/log/sentry/v2/api/slardar/crash/",_t="session",bt="3.2.25",St="SDK_SLARDAR_ELECTRON",wt={sample_rate:1,include_users:[],sample_granularity:_t,rules:{}},Et="SLARDAR",It=function(t,e){return void 0===e&&(e=ht),((t=void 0===t?dt:t)&&0<=t.indexOf("//")?"":"https://")+t+e},Rt=function(t,e){return void 0===e&&(e=gt),((t=void 0===t?mt:t)&&0<=t.indexOf("//")?"":"http://")+t+e};function Ot(t,e,n){e=null===(t=t.config())||void 0===t?void 0:t.plugins[e];return I(e)?f(f({},n),e):!!e&&n}function Ct(t,e){return t&&e&&t===e}function At(t){var e;return x(t)?e=M(t,Dt):(v(t)||D(t)||A(t))&&(e={message:k(t)}),e}var xt=function(t,e){return!(!t||!e)&&!(!Ct(t.message,e.message)&&!Ct(t.stack,e.stack))},Dt=["name","message","stack","filename","lineno","colno"],jt="jsError",Pt="js_error",Tt={ignoreErrors:[],uncaughtException:!0,unhandledRejection:!0,dedupe:!1};function Nt(n){n.on("init",function(){var t,e=Ot(n,jt,Tt);e&&(e=(t=g(et(Mt,e,function(t){n.report(t)},[process]),2))[0],t=t[1],n.on("beforeDestroy",t),n.provide("captureException",e))})}var Mt=function(d){if(d=void 0===d?null:d)return function(t,n){var e,r,o,i=t.ignoreErrors,c=t.uncaughtException,u=t.unhandledRejection,a=t.dedupe,s=L(i),l=[],f=function(t){if(!xt(t,e))return e=t;e=t},p=function(t,e){t=a?f(t):t;n&&t&&(null!=s&&s.test(t.message)||n({ev_type:Pt,payload:{error:t,breadcrumbs:[],extra:e}}))};c&&(d.on("uncaughtException",r=function(t){try{p(At(t))}catch(t){}}),l.push(function(){return d.off("uncaughtException",r)})),u&&(d.on("unhandledRejection",o=function(t){return p(At(t))}),l.push(function(){return d.off("unhandledRejection",o)}));return[function(t,e){return p(V(t),e)},function(){l.forEach(function(t){return t()})}]}};function Lt(t){var e=[],n=t;function r(){return e.shift()}function o(){return e.length}function i(){for(;o()>n;)r()}return{enqueue:function(t){e.push(t),i()},dequeue:r,clear:function(){e=[]},getSize:o,setCapacity:function(t){n=t,i()},getCapacity:function(){return n}}}var kt=10;function Ft(t){var a=t.reduce(function(t,e){if(t[e.name])throw Error("name "+e.name+" is exist");return t[e.name]=f(f({},e),{_state:"stop"}),t},{});function c(t){if(!a[t])throw Error("Sample "+t+" does not exist")}function s(t,e){var n=a[t],t=n.reportCb,n=n.sampleRate;Math.random()<=n&&t(e)}function o(u){return p(this,void 0,void 0,function(){function e(t){"pause"===o?null!=i&&i.enqueue(t):s(u,t)}var n,r,o,i,c;return d(this,function(t){switch(t.label){case 0:return n=a[u],c=n.collectCb,r=n.async,o=n._state,i=n._queue,(c=c())instanceof Promise?null!=r&&r.isWaitTillReturn?[4,c]:[3,2]:[3,4];case 1:return e(t.sent()),[3,3];case 2:c.then(e),t.label=3;case 3:return[3,5];case 4:e(c),t.label=5;case 5:return[2]}})})}function i(n,r){return p(this,void 0,void 0,function(){var e;return d(this,function(t){switch(t.label){case 0:return e=a[n].collectInterval,r?[4,o(n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return a[n]._tid=setTimeout(function(){!function(){p(this,void 0,void 0,function(){return d(this,function(t){switch(t.label){case 0:return[4,o(n)];case 1:return t.sent(),i(n,!1),[2]}})})}()},e),[2]}})})}function u(t,e,n){var r;a[t]._state=n,null!==(t=(r=a[t]).transSucCb)&&void 0!==t&&t.call(r,e,n)}function r(t,e){void 0===e&&(e={isReportAll:!0}),c(t);var n=a[t],r=n._tid,o=n._state,i=n._queue,n=!1;if("running"===o)n=!0;else if("pause"===o){if(e.isReportAll)for(;null!=i&&i.getSize();)s(t,i.dequeue());null!==(e=a[t]._queue)&&void 0!==e&&e.clear(),n=!0}return n&&(clearTimeout(r),u(t,o,"stop")),n}function l(t,e){void 0===e&&(e={isImmediately:!1}),c(t);var n=a[t],r=n._state,o=n._queue,n=!1;if("stop"===r)i(t,e.isImmediately),n=!0;else if("pause"===r){for(;null!=o&&o.getSize();)s(t,o.dequeue());n=!0}return n&&u(t,r,"running"),n}return{startAction:l,stopAction:r,pauseAction:function(t,e){void 0===e&&(e={capacity:kt}),c(t);var n=a[t]._state,r=!1;return"running"===n&&(r=!0,a[t]._queue=Lt(e.capacity)),r&&u(t,n,"pause"),r},update:function(t,e,n){void 0===n&&(n={isReStartImmediately:!1}),c(t),a[t]=f(f({},a[t]),e),n.isReStartImmediately&&(r(t,n.stopOptions),l(t,n.startOptions))},getState:function(t){return a[t]._state},getQueueSize:function(t){return null!==(t=null===(t=a[t]._queue)||void 0===t?void 0:t.getSize())&&void 0!==t?t:0}}}var Ut="pcPerf",qt={cpu:{collectInterval:6e4,sampleRate:1,dataGetter:function(){return{}}},memory:{collectInterval:6e4,sampleRate:1,dataGetter:function(){return{}}}};function Gt(n){n.on("init",function(){var t,e=Ot(n,Ut,qt);e&&(e=(t=g(et($t,e,function(t){n.report(t)},[]),2))[0],t=t[1],n.on("beforeDestroy",t),n.provide("sampleController",e))})}function zt(t,e){var n={};return n.bid=e.bid,n.pid=e.pid,n.view_id=e.viewId,n.user_id=e.userId,n.device_id=e.deviceId,n.session_id=e.sessionId,n.release=e.release,n.env=e.env,f(f({},t),{extra:f(f({},n),t.extra||{})})}function Kt(t){var e={timestamp:Date.now(),sdk_version:bt,sdk_name:St};return f(f({},t),{extra:f(f({},e),null!==(t=t.extra)&&void 0!==t?t:{})})}var $t=function(){return function(t,r){function e(t,e,n){r&&r({ev_type:"custom",payload:{name:t,metrics:e,categories:n,type:"event"}})}var n,o=t.cpu,i=t.memory,t=[];o&&t.push({name:"cpu",collectInterval:null!==(n=o.collectInterval)&&void 0!==n?n:6e4,sampleRate:null!==(n=o.sampleRate)&&void 0!==n?n:1,transSucCb:o.transSucCb,async:o.async,collectCb:o.dataGetter,reportCb:function(t){return e("cpu",f(f({},t),o.extraMetrics),o.categories)}}),i&&t.push({name:"memory",collectInterval:null!==(n=i.collectInterval)&&void 0!==n?n:6e4,sampleRate:null!==(n=i.sampleRate)&&void 0!==n?n:1,transSucCb:i.transSucCb,async:i.async,collectCb:i.dataGetter,reportCb:function(t){return e("memory",f(f({},t),i.extraMetrics),i.categories)}});var c=Ft(t);t.forEach(function(t){t=t.name;return c.startAction(t)});return[c,function(){c.stopAction("cpu",{isReportAll:!0}),c.stopAction("memory",{isReportAll:!0})}]}},Bt=function(e){e.on("beforeBuild",function(t){return zt(t,e.config())})},Yt=function(t){t.on("report",Kt)},Wt="crash",Ht={crashReporter:null};function Jt(l){l.on("init",function(){var t,e,n,r,o,c,u,i=Ot(l,Wt,Ht);function a(t,e){return{extra:{bid:t.bid,ev_type:"pc_crash",slardar_web_id:"string"==typeof t.deviceId?t.deviceId:"",slardar_session_id:t.sessionId,context:k(null==e?void 0:e.toString())}}}function s(n,t){n&&Object.entries(t).forEach(function(t){var e=g(t,2),t=e[0],e=e[1];n.addExtraParameter(t,e)})}i&&(t=l.config(),e=t,n=l.context,r=Rt(e.crashDomain,e.crashPath),i&&i.crashReporter&&i.crashReporter.start(f({compress:!1,companyName:"CrashReporterPlugin",productName:"Slardar_Crash_Report",submitURL:r},a(e,n))),o=Vt(l.context,function(){s(i.crashReporter,a(l.config(),l.context).extra)}).restoreFns,c=!1,u=["bid","deviceId","sessionId"],l.on("beforeConfig",function(t){var e,n;try{for(var r=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return{value:(t=t&&r>=t.length?void 0:t)&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(u),o=r.next();!o.done;o=r.next()){var i=o.value;if(t[i]&&l.config()[i]!==t[i])return void(c=!0)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}}),l.on("config",function(){c&&s(i.crashReporter,a(l.config(),l.context).extra),c=!1}),l.on("beforeDestroy",function(){o.forEach(function(t){return t()})}))})}function Vt(o,i){return{restoreFns:["set","merge","delete","clear"].map(function(t){return F(o,t,function(r){return function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=r.apply(o,t);return i(),n}})()})}}var Qt,o="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},Xt={exports:{}},Zt=e.default,te=process.cwd,ee=null,ne=process.env.GRACEFUL_FS_PLATFORM||process.platform;process.cwd=function(){return ee=ee||te.call(process)};try{process.cwd()}catch(t){}"function"==typeof process.chdir&&(Qt=process.chdir,process.chdir=function(t){ee=null,Qt.call(process,t)},Object.setPrototypeOf&&Object.setPrototypeOf(process.chdir,Qt));i=function(p){Zt.hasOwnProperty("O_SYMLINK")&&process.version.match(/^v0\.6\.[0-2]|^v0\.5\./)&&function(o){o.lchmod=function(t,e,r){o.open(t,Zt.O_WRONLY|Zt.O_SYMLINK,e,function(t,n){t?r&&r(t):o.fchmod(n,e,function(e){o.close(n,function(t){r&&r(e||t)})})})},o.lchmodSync=function(t,e){var n,r=o.openSync(t,Zt.O_WRONLY|Zt.O_SYMLINK,e),t=!0;try{n=o.fchmodSync(r,e),t=!1}finally{if(t)try{o.closeSync(r)}catch(t){}else o.closeSync(r)}return n}}(p);p.lutimes||function(i){Zt.hasOwnProperty("O_SYMLINK")?(i.lutimes=function(t,e,r,o){i.open(t,Zt.O_SYMLINK,function(t,n){t?o&&o(t):i.futimes(n,e,r,function(e){i.close(n,function(t){o&&o(e||t)})})})},i.lutimesSync=function(t,e,n){var r,o=i.openSync(t,Zt.O_SYMLINK),t=!0;try{r=i.futimesSync(o,e,n),t=!1}finally{if(t)try{i.closeSync(o)}catch(t){}else i.closeSync(o)}return r}):(i.lutimes=function(t,e,n,r){r&&process.nextTick(r)},i.lutimesSync=function(){})}(p);p.chown=n(p.chown),p.fchown=n(p.fchown),p.lchown=n(p.lchown),p.chmod=t(p.chmod),p.fchmod=t(p.fchmod),p.lchmod=t(p.lchmod),p.chownSync=r(p.chownSync),p.fchownSync=r(p.fchownSync),p.lchownSync=r(p.lchownSync),p.chmodSync=e(p.chmodSync),p.fchmodSync=e(p.fchmodSync),p.lchmodSync=e(p.lchmodSync),p.stat=o(p.stat),p.fstat=o(p.fstat),p.lstat=o(p.lstat),p.statSync=i(p.statSync),p.fstatSync=i(p.fstatSync),p.lstatSync=i(p.lstatSync),p.lchmod||(p.lchmod=function(t,e,n){n&&process.nextTick(n)},p.lchmodSync=function(){});p.lchown||(p.lchown=function(t,e,n,r){r&&process.nextTick(r)},p.lchownSync=function(){});"win32"===ne&&(p.rename=function(u){return function(o,i,c){var t=Date.now(),e=0;u(o,i,function n(r){return r&&("EACCES"===r.code||"EPERM"===r.code)&&Date.now()-t<6e4?(setTimeout(function(){p.stat(i,function(t,e){t&&"ENOENT"===t.code?u(o,i,n):c(r)})},e),void(e<100&&(e+=10))):void(c&&c(r))})}}(p.rename));function t(r){return r&&function(t,e,n){return r.call(p,t,e,function(t){c(t)&&(t=null),n&&n.apply(this,arguments)})}}function e(n){return n&&function(t,e){try{return n.call(p,t,e)}catch(t){if(!c(t))throw t}}}function n(o){return o&&function(t,e,n,r){return o.call(p,t,e,n,function(t){c(t)&&(t=null),r&&r.apply(this,arguments)})}}function r(r){return r&&function(t,e,n){try{return r.call(p,t,e,n)}catch(t){if(!c(t))throw t}}}function o(o){return o&&function(t,e,n){function r(t,e){e&&(e.uid<0&&(e.uid+=4294967296),e.gid<0&&(e.gid+=4294967296)),n&&n.apply(this,arguments)}return"function"==typeof e&&(n=e,e=null),e?o.call(p,t,e,r):o.call(p,t,r)}}function i(n){return n&&function(t,e){t=e?n.call(p,t,e):n.call(p,t);return t.uid<0&&(t.uid+=4294967296),t.gid<0&&(t.gid+=4294967296),t}}function c(t){return!t||("ENOSYS"===t.code||!(process.getuid&&0===process.getuid()||"EINVAL"!==t.code&&"EPERM"!==t.code))}p.read=function(f){function t(r,o,i,c,u,a){var s,l;return a&&"function"==typeof a&&(s=0,l=function(t,e,n){if(t&&"EAGAIN"===t.code&&s<10)return s++,f.call(p,r,o,i,c,u,l);a.apply(this,arguments)}),f.call(p,r,o,i,c,u,l)}return Object.setPrototypeOf&&Object.setPrototypeOf(t,f),t}(p.read),p.readSync=function(c){return function(t,e,n,r,o){for(var i=0;;)try{return c.call(p,t,e,n,r,o)}catch(t){if("EAGAIN"===t.code&&i<10){i++;continue}throw t}}}(p.readSync)};var re=n.default.Stream,c=function(a){return{ReadStream:function t(e,n){if(!(this instanceof t))return new t(e,n);re.call(this);var r=this;this.path=e;this.fd=null;this.readable=!0;this.paused=!1;this.flags="r";this.mode=438;this.bufferSize=65536;n=n||{};var o=Object.keys(n);for(var i=0,c=o.length;i<c;i++){var u=o[i];this[u]=n[u]}this.encoding&&this.setEncoding(this.encoding);if(void 0!==this.start){if("number"!=typeof this.start)throw TypeError("start must be a Number");if(void 0===this.end)this.end=1/0;else if("number"!=typeof this.end)throw TypeError("end must be a Number");if(this.start>this.end)throw new Error("start must be <= end");this.pos=this.start}if(null!==this.fd)return void process.nextTick(function(){r._read()});a.open(this.path,this.flags,this.mode,function(t,e){return t?(r.emit("error",t),void(r.readable=!1)):(r.fd=e,r.emit("open",e),void r._read())})},WriteStream:function t(e,n){if(!(this instanceof t))return new t(e,n);re.call(this);this.path=e;this.fd=null;this.writable=!0;this.flags="w";this.encoding="binary";this.mode=438;this.bytesWritten=0;n=n||{};var r=Object.keys(n);for(var o=0,i=r.length;o<i;o++){var c=r[o];this[c]=n[c]}if(void 0!==this.start){if("number"!=typeof this.start)throw TypeError("start must be a Number");if(this.start<0)throw new Error("start must be >= zero");this.pos=this.start}this.busy=!1;this._queue=[];null===this.fd&&(this._open=a.open,this._queue.push([this._open,this.path,this.flags,this.mode,void 0]),this.flush())}}};var u=function(e){if(null===e||"object"!=typeof e)return e;{var n;n=e instanceof Object?{__proto__:oe(e)}:Object.create(null)}return Object.getOwnPropertyNames(e).forEach(function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(e,t))}),n},oe=Object.getPrototypeOf||function(t){return t.__proto__};var ie,ce,ue,ae=b.default,se=i,le=c,e=u,n=r.default;function fe(t,e){Object.defineProperty(t,ie,{get:function(){return e}})}function pe(t){ce.apply(ae,arguments),me()}function de(t,e){return ue.call(ae,t,function(t){t||me(),"function"==typeof e&&e.apply(this,arguments)})}i="function"==typeof Symbol&&"function"==typeof Symbol.for?(ie=Symbol.for("graceful-fs.queue"),Symbol.for("graceful-fs.previous")):(ie="___graceful-fs.queue","___graceful-fs.previous"),n.debuglog?n.debuglog("gfs4"):/\bgfs4\b/i.test(process.env.NODE_DEBUG||""),ae[ie]||(fe(ae,o[ie]||[]),ae.close=(ue=ae.close,Object.defineProperty(de,i,{value:ue}),de),ae.closeSync=(ce=ae.closeSync,Object.defineProperty(pe,i,{value:ce}),pe),/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&process.on("exit",function(){s.default.equal(ae[ie].length,0)})),o[ie]||fe(o,ae[ie]);var he,c=ye(e(ae));function ye(n){se(n),n.gracefulify=ye,n.createReadStream=function(t,e){return new n.ReadStream(t,e)},n.createWriteStream=function(t,e){return new n.WriteStream(t,e)};var c=n.readFile;n.readFile=function(t,e,n){"function"==typeof e&&(n=e,e=null);return function e(n,r,o,i){return c(n,r,function(t){!t||"EMFILE"!==t.code&&"ENFILE"!==t.code?"function"==typeof o&&o.apply(this,arguments):ve([e,[n,r,o],t,i||Date.now(),Date.now()])})}(t,e,n)};var u=n.writeFile;n.writeFile=function(t,e,n,r){"function"==typeof n&&(r=n,n=null);return function e(n,r,o,i,c){return u(n,r,o,function(t){!t||"EMFILE"!==t.code&&"ENFILE"!==t.code?"function"==typeof i&&i.apply(this,arguments):ve([e,[n,r,o,i],t,c||Date.now(),Date.now()])})}(t,e,n,r)};var a=n.appendFile;a&&(n.appendFile=function(t,e,n,r){"function"==typeof n&&(r=n,n=null);return function e(n,r,o,i,c){return a(n,r,o,function(t){!t||"EMFILE"!==t.code&&"ENFILE"!==t.code?"function"==typeof i&&i.apply(this,arguments):ve([e,[n,r,o,i],t,c||Date.now(),Date.now()])})}(t,e,n,r)});var s=n.copyFile;s&&(n.copyFile=function(t,e,n,r){"function"==typeof n&&(r=n,n=0);return function e(n,r,o,i,c){return s(n,r,o,function(t){!t||"EMFILE"!==t.code&&"ENFILE"!==t.code?"function"==typeof i&&i.apply(this,arguments):ve([e,[n,r,o,i],t,c||Date.now(),Date.now()])})}(t,e,n,r)});var t,l=n.readdir;n.readdir=function(t,e,n){"function"==typeof e&&(n=e,e=null);return function n(r,o,i,c){return l(r,o,function(t,e){!t||"EMFILE"!==t.code&&"ENFILE"!==t.code?(e&&e.sort&&e.sort(),"function"==typeof i&&i.call(this,t,e)):ve([n,[r,o,i],t,c||Date.now(),Date.now()])})}(t,e,n)},"v0.8"===process.version.substr(0,4)&&(f=(t=le(n)).ReadStream,p=t.WriteStream);var r=n.ReadStream;r&&(f.prototype=Object.create(r.prototype),f.prototype.open=function(){var n=this;h(n.path,n.flags,n.mode,function(t,e){t?(n.autoClose&&n.destroy(),n.emit("error",t)):(n.fd=e,n.emit("open",e),n.read())})});var o=n.WriteStream;o&&(p.prototype=Object.create(o.prototype),p.prototype.open=function(){var n=this;h(n.path,n.flags,n.mode,function(t,e){t?(n.destroy(),n.emit("error",t)):(n.fd=e,n.emit("open",e))})}),Object.defineProperty(n,"ReadStream",{get:function(){return f},set:function(t){f=t},enumerable:!0,configurable:!0}),Object.defineProperty(n,"WriteStream",{get:function(){return p},set:function(t){p=t},enumerable:!0,configurable:!0});var e=f;Object.defineProperty(n,"FileReadStream",{get:function(){return e},set:function(t){e=t},enumerable:!0,configurable:!0});var i=p;function f(t,e){return this instanceof f?(r.apply(this,arguments),this):f.apply(Object.create(f.prototype),arguments)}function p(t,e){return this instanceof p?(o.apply(this,arguments),this):p.apply(Object.create(p.prototype),arguments)}Object.defineProperty(n,"FileWriteStream",{get:function(){return i},set:function(t){i=t},enumerable:!0,configurable:!0});var d=n.open;function h(t,e,n,r){return"function"==typeof n&&(r=n,n=null),function n(r,o,i,c,u){return d(r,o,i,function(t,e){!t||"EMFILE"!==t.code&&"ENFILE"!==t.code?"function"==typeof c&&c.apply(this,arguments):ve([n,[r,o,i,c],t,u||Date.now(),Date.now()])})}(t,e,n,r)}return n.open=h,n}function ve(t){ae[ie].push(t),ge()}function me(){for(var t=Date.now(),e=0;e<ae[ie].length;++e)2<ae[ie][e].length&&(ae[ie][e][3]=t,ae[ie][e][4]=t);ge()}function ge(){var t,e,n,r,o,i,c;clearTimeout(he),he=void 0,0!==ae[ie].length&&(e=(t=ae[ie].shift())[0],n=t[1],i=t[2],r=t[3],c=t[4],void 0===r?e.apply(null,n):6e4<=Date.now()-r?"function"==typeof(o=n.pop())&&o.call(null,i):(i=Date.now()-c,c=Math.max(c-r,1),Math.min(1.2*c,100)<=i?e.apply(null,n.concat([r])):ae[ie].push(t)),void 0===he&&(he=setTimeout(ge,0)))}process.env.TEST_GRACEFUL_FS_GLOBAL_PATCH&&!ae.__patched&&(c=ye(ae),ae.__patched=!0);u={},n=function(){var o=Array.prototype.slice.call(arguments),i=o.shift()||[],c=o.pop();if("function"!=typeof c)throw new Error("No callback provided to asyncMap");if(!i)return c(null,[]);Array.isArray(i)||(i=[i]);var u=o.length,a=[],s=null,l=i.length,f=l*u;if(!f)return c(null,[]);function p(t){t&&!s&&(s=t);for(var e,n=arguments.length,r=1;r<n;r++)void 0!==arguments[r]&&(a[r-1]=(a[r-1]||[]).concat(arguments[r]));i.length>l&&(e=i.slice(l),f+=(i.length-l)*u,l=i.length,process.nextTick(function(){e.forEach(function(e){o.forEach(function(t){t(e,p)})})})),0==--f&&c.apply(null,[s].concat(a))}i.forEach(function(e){o.forEach(function(t){t(e,p)})})};i=function(){var e,n=Array.prototype.slice.call(arguments),r=null;"object"==typeof n[0]?(r=n.shift(),"string"==typeof(e=n.shift())&&(e=r[e])):e=n.shift();return function(t){e.apply(r,n.concat(t))}};var e=be,_e=i;function be(t,i){var c=[];!function n(r,o){return o<=r?i(null,c):(Array.isArray(t[r])&&(t[r]=_e.apply(null,t[r].map(function(t){return t===be.first?c[0]:t===be.last?c[c.length-1]:t}))),t[r]?void t[r](function(t,e){return t?i(t,c):(void 0!==e&&(c=c.concat(e)),void n(r+1,o))}):n(r+1,o))}(0,t.length)}be.first={},be.last={},u.asyncMap=n,u.bindActor=i,u.chain=e;var Se,i={exports:{}};function we(t,e){var n=this instanceof we?this:Se;if(n.reset(e),"string"==typeof t&&0<t.length&&n.hash(t),n!==this)return n}e=i,we.prototype.hash=function(t){var e,n,r,o,i=t.length;switch(this.len+=i,n=this.k1,this.rem){case r=0:n^=r<i?65535&t.charCodeAt(r++):0;case 1:n^=r<i?(65535&t.charCodeAt(r++))<<8:0;case 2:n^=r<i?(65535&t.charCodeAt(r++))<<16:0;case 3:n^=r<i?(255&t.charCodeAt(r))<<24:0,n^=r<i?(65280&t.charCodeAt(r++))>>8:0}if(this.rem=i+this.rem&3,0<(i-=this.rem)){for(e=this.h1;;){if(e=5*(e=(e^=n=13715*(n=(n=11601*n+3432906752*(65535&n)&4294967295)<<15|n>>>17)+461832192*(65535&n)&4294967295)<<13|e>>>19)+3864292196&4294967295,i<=r)break;n=65535&t.charCodeAt(r++)^(65535&t.charCodeAt(r++))<<8^(65535&t.charCodeAt(r++))<<16,n^=(255&(o=t.charCodeAt(r++)))<<24^(65280&o)>>8}switch(n=0,this.rem){case 3:n^=(65535&t.charCodeAt(r+2))<<16;case 2:n^=(65535&t.charCodeAt(r+1))<<8;case 1:n^=65535&t.charCodeAt(r)}this.h1=e}return this.k1=n,this},we.prototype.result=function(){var t=this.k1,e=this.h1;return 0<t&&(e^=13715*(t=(t=11601*t+3432906752*(65535&t)&4294967295)<<15|t>>>17)+461832192*(65535&t)&4294967295),e^=this.len,e=51819*(e^=e>>>16)+2246770688*(65535&e)&4294967295,e=44597*(e^=e>>>13)+3266445312*(65535&e)&4294967295,(e^=e>>>16)>>>0},we.prototype.reset=function(t){return this.h1="number"==typeof t?t:0,this.rem=this.k1=this.len=0,this},Se=new we,e.exports=we,Xt.exports=function(s,l,f,p){f instanceof Function&&(p=f,f=null);f=f||{};Ie.realpath(s,function(t,e){function n(){Re([[r,a,i,c.mode,c.encoding||"utf8"],c.chown&&[Ie,Ie.chown,a,c.chown.uid,c.chown.gid],c.mode&&[Ie,Ie.chmod,a,c.mode],[Ie,Ie.rename,a,o]],function(t){t?Ie.unlink(a,function(){u(t)}):u()})}function r(t,r,e,o,i){Ie.open(t,"w",c.mode,function(t,e){return t?i(t):Buffer.isBuffer(r)?Ie.write(e,r,0,r.length,0,n):null!=r?Ie.write(e,String(r),0,String(o),n):n();function n(t){if(t)return i(t);Ie.fsync(e,function(t){return t?i(t):void Ie.close(e,i)})}})}var o,i,c,u,a;i=l,c=f,u=p,a=xe(o=e||s),c.mode&&c.chown?n():Ie.stat(o,function(t,e){return t||!e||((c=Ce({},c)).mode||(c.mode=e.mode),!c.chown&&process.getuid&&(c.chown={uid:e.uid,gid:e.gid})),n()})})},Xt.exports.sync=function(t,e,n){n=n||{};try{t=Ie.realpathSync(t)}catch(t){}var r=xe(t);try{if(!n.mode||!n.chown)try{var o=Ie.statSync(t);(n=Ce({},n)).mode||(n.mode=o.mode),!n.chown&&process.getuid&&(n.chown={uid:o.uid,gid:o.gid})}catch(t){}var i=Ie.openSync(r,"w",n.mode);Buffer.isBuffer(e)?Ie.writeSync(i,e,0,e.length,0):null!=e&&Ie.writeSync(i,String(e),0,String(n.encoding||"utf8")),Ie.fsyncSync(i),Ie.closeSync(i),n.chown&&Ie.chownSync(r,n.chown.uid,n.chown.gid),n.mode&&Ie.chmodSync(r,n.mode),Ie.renameSync(r,t)}catch(t){try{Ie.unlinkSync(r)}catch(t){}throw t}},Xt.exports._getTmpname=xe;var Ee,Ie=c,Re=u.chain,Oe=i.exports,Ce=Object.assign||r.default._extend,Ae=0;function xe(t){return t+"."+Oe(__filename).hash(String(process.pid)).hash(String(++Ae)).result()}!function(){var e,l,f,p,n,d,u,o,s,h,y,t,r,i,c=function(t,e){for(var n in e)a.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},a={}.hasOwnProperty;function v(t){this.message=null!=t?t:"Unknown error.",v.__super__.constructor.call(this),null!=Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name=this.constructor.name}function m(t,e){var n,r;return this._location=t,this.quota=null!=e?e:5242880,m.__super__.constructor.call(this),this instanceof m?(this._location=h.resolve(this._location),null!=i[this._location]?i[this._location]:(this.length=0,this._bytesInUse=0,this._keys=[],this._metaKeyMap=o(),this._eventUrl="pid:"+process.pid,this._init(),this._QUOTA_EXCEEDED_ERR=f,"undefined"!=typeof Proxy&&null!==Proxy?(e={set:function(t,e,n){return null!=r[e]?r[e]=n:r.setItem(e,n)},get:function(t,e){return null!=n[e]?n[e]:n.getItem(e)}},i[(n=r=this)._location]=new Proxy(this,e)):i[this._location]=this,i[this._location])):new m(this._location,this.quota)}function g(){return g.__super__.constructor.apply(this,arguments)}h=_.default,s=b.default,r=S.default,y=Xt.exports.sync,e="---.EMPTY_STRING.---",n=function(t){for(var e,n=s.readdirSync(t),r=[],o=0,i=n.length;o<i;o++)e=n[o],r.push(u(h.join(t,e)));return r},u=function(t){return s.statSync(t).isDirectory()?(n(t),s.rmdirSync(t)):s.unlinkSync(t)},d=function(t){t=""===t?e:""+t;return t},t=Error,c(v,t),v.prototype.toString=function(){return this.name+": "+this.message},f=v,p=function(t,e,n,r,o){this.key=t,this.oldValue=e,this.newValue=n,this.url=r,this.storageArea=null!=o?o:"localStorage"},l=function t(e,n){if(this.key=e,this.index=n,!(this instanceof t))return new t(this.key,this.index)},o=function(){var t=function(){};return t.prototype=Object.create(null),new t},r=r.EventEmitter,c(m,r),i={},m.prototype._init=function(){var t,e,n,r,o,i,c,u,a;try{if(null!=(a=s.statSync(this._location))&&!a.isDirectory())throw new Error("A file exists at the location '"+this._location+"' when trying to create/open localStorage");for(this._bytesInUse=0,this.length=0,n=s.readdirSync(this._location),i=o=0,u=n.length;o<u;i=++o)c=n[i],e=decodeURIComponent(c),this._keys.push(e),t=new l(c,i),this._metaKeyMap[e]=t,null!=(null!=(a=this._getStat(c))?a.size:void 0)&&(t.size=a.size,this._bytesInUse+=a.size);this.length=n.length}catch(t){if("ENOENT"!==(r=t).code)throw r;try{s.mkdirSync(this._location,{recursive:!0})}catch(t){if("EEXIST"!==(r=t).code)throw r}}},m.prototype.setItem=function(t,e){var n,r,o,i,c,u,a=this.listenerCount("storage"),s=null;if(a&&(s=this.getItem(t)),t=d(t),n=encodeURIComponent(t).replace(/[!'()]/g,escape).replace(/\*/g,"%2A"),o=h.join(this._location,n),u=(r=!!(i=this._metaKeyMap[t]))?i.size:0,this._bytesInUse-u+(u=(c=""+e).length)>this.quota)throw new f;if(y(o,c,{encoding:"utf8"}),r||((i=new l(n,this._keys.push(t)-1)).size=u,this._metaKeyMap[t]=i,this.length+=1,this._bytesInUse+=u),a)return e=new p(t,s,e,this._eventUrl),this.emit("storage",e)},m.prototype.getItem=function(t){return t=d(t),(t=this._metaKeyMap[t])?(t=h.join(this._location,t.key),s.readFileSync(t,"utf8")):null},m.prototype._getStat=function(t){t=d(t),t=h.join(this._location,encodeURIComponent(t));try{return s.statSync(t)}catch(t){return null}},m.prototype.removeItem=function(t){var e,n,r,o,i,c;if(t=d(t),i=this._metaKeyMap[t]){for(r in c=null,(n=this.listenerCount("storage"))&&(c=this.getItem(t)),delete this._metaKeyMap[t],--this.length,this._bytesInUse-=i.size,e=h.join(this._location,i.key),this._keys.splice(i.index,1),this._metaKeyMap)(o=this._metaKeyMap[r]).index>i.index&&--o.index;if(u(e),n)return c=new p(t,c,null,this._eventUrl),this.emit("storage",c)}},m.prototype.key=function(t){t=this._keys[t];return t===e?"":t},m.prototype.clear=function(){var t;if(n(this._location),this._metaKeyMap=o(),this._keys=[],this.length=0,this._bytesInUse=0,this.listenerCount("storage"))return t=new p(null,null,null,this._eventUrl),this.emit("storage",t)},m.prototype._getBytesInUse=function(){return this._bytesInUse},m.prototype._deleteLocation=function(){return delete i[this._location],u(this._location),this._metaKeyMap={},this._keys=[],this.length=0,this._bytesInUse=0},c(g,c=m),g.prototype.setItem=function(t,e){e=JSON.stringify(e);return g.__super__.setItem.call(this,t,e)},g.prototype.getItem=function(t){return JSON.parse(g.__super__.getItem.call(this,t))},Ee=c}.call(o);function De(t,e){return e?(t=Te(t=void 0===t?"":t),null!==(e=Ne.get(t,e))&&void 0!==e?e:{userId:"",deviceId:""}):{userId:"",deviceId:""}}function je(t,e){return!!e&&(t=Te(t=void 0===t?"":t),!!Ne.get(t,e))}function Pe(t){var e=t.bid,n=t.userId,r=t.deviceId;(t=t.localDataPath)&&(e=Te(e),Ne.set(e,{userId:n,deviceId:r},t))}var Te=function(t){return Et+t},Ne={get:function(t,e){t=new Ee(e).getItem(t);return t&&JSON.parse(t)},set:function(t,e,n){new Ee(n).setItem(t,k(e))}},Me=function(t){var e=De(t.bid,t.localDataPath);return{bid:"",pid:"",localDataPath:"",viewId:"_"+Date.now(),userId:null!==(t=e.userId)&&void 0!==t?t:"",deviceId:null!==(e=e.deviceId)&&void 0!==e?e:"",sessionId:Y(),reportDomain:dt,reportPath:ht,serverDomain:vt,serverPath:yt,crashDomain:mt,crashPath:gt,plugins:Le,release:"",env:"production",transport:{get:h,post:h},sample:wt}},i=Y,Le=((r={})[Ut]={cpu:{dataGetter:h},memory:{dataGetter:h}},r[Wt]={crashReporter:null},r[jt]={},r),ke=function(t,e){return void 0===e&&(e=yt),((t=void 0===t?vt:t)&&0<=t.indexOf("//")?"":"https://")+t+e};function Fe(t){return I(t)&&"bid"in t&&!!t.bid}function Ue(t){return f({},t)}function qe(t){var e,n,r=null!==(e=t.plugins)&&void 0!==e?e:{};for(n in r)r[n]&&!I(r[n])&&(r[n]={});return f(f({},t),Le)}function Ge(t){if(!t)return{};var e=t.sample,n=t.user_id,r=t.timestamp;if(!e)return{userId:n};var o=e.sample_rate,i=e.sample_granularity,t=e.include_users,e=e.rules;return{userId:n,sample:{include_users:t,sample_rate:o,sample_granularity:void 0===i?_t:i,rules:(void 0===e?[]:e).reduce(function(t,e){var n=e.name,r=e.enable,o=e.sample_rate,e=e.conditional_sample_rules;return t[n]={enable:r,sample_rate:o,conditional_sample_rules:e},t},{})},plugins:Le,serverTimestamp:r}}var ze={get:function(){return this.__SLARDAR__REPALCE__HOLDER__}},Ke=function(e){var n,r,o=e,i={},c=ze.get(),u=h,a=h;return{getConfig:function(){return o},setConfig:function(t){return i=f(f({},i),t||{}),s(),n||(n=t,o.useLocalConfig||!o.bid?(r={},u()):c?l():$e(o,function(t){c=t,l()})),o},onChange:function(t){a=t},onReady:function(t){u=function(){Pe(o),t()},r&&u()}};function s(){var t=f(f(f({},e),r||{}),i);t.plugins=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n={},r=0;r<t.length;)n=j(n,t[r++]);return n}(e.plugins,(null==r?void 0:r.plugins)||{},i.plugins||{}),t.sample=Be(Be(e.sample,null==r?void 0:r.sample),i.sample),o=t,a()}function l(){r=Ge(c),je(o.bid,o.localDataPath)&&(r.userId=e.userId),s(),u()}};function $e(t,e){var n=t.transport,r=t.serverDomain,o=t.serverPath,t=t.bid;n.get({url:ke(r,o)+"?bid="+t+"&store=1",success:function(t){e(t.data||{})},fail:function(){e({sample:{sample_rate:.001}})}})}function Be(r,o){if(!r||!o)return r||o;var t=f(f({},r),o);return t.include_users=w(w([],g(r.include_users||[]),!1),g(o.include_users||[]),!1),t.rules=w(w([],g(Object.keys(r.rules||{})),!1),g(Object.keys(o.rules||{})),!1).reduce(function(t,e){var n;return e in t||(e in(r.rules||{})&&e in(o.rules||{})?(t[e]=f(f({},r.rules[e]),o.rules[e]),t[e].conditional_sample_rules=w(w([],g(r.rules[e].conditional_sample_rules||[]),!1),g(o.rules[e].conditional_sample_rules||[]),!1)):t[e]=(null===(n=r.rules)||void 0===n?void 0:n[e])||(null===(n=o.rules)||void 0===n?void 0:n[e])),t},{}),t}function Ye(t){var n,e=void 0===t?{}:t,r=e.createSender,t=e.builder,r=function(t){var n,r,e=t.builder,o=t.createSender,i=t.createDefaultConfig,c=t.createConfigManager,u=t.userConfigNormalizer,a=t.initConfigNormalizer,s=t.validateInitConfig,l={};E.forEach(function(t){return l[t]=[]});var f=!1,p=!1,d=!1,h=[],y=[],v={getBuilder:function(){return e},getSender:function(){return n},getPreStartQueue:function(){return h},init:function(t){if(f)U("already inited");else{if(!(t&&I(t)&&s(t)))throw new Error("invalid InitConfig, init failed");var e=i(t);if(!e)throw new Error("defaultConfig missing");t=a(t);if((r=c(e)).setConfig(t),r.onChange(function(){m("config")}),!(n=o(r.getConfig())))throw new Error("sender missing");m("init",f=!0)}},set:function(t){f&&t&&I(t)&&(m("beforeConfig",!1,t),null!=r&&r.setConfig(t))},config:function(t){if(f)return t&&I(t)&&(m("beforeConfig",!1,t),null!=r&&r.setConfig(u(t))),null==r?void 0:r.getConfig()},provide:function(t,e){P(y,t)?U("cannot provide "+t+", reserved"):(v[t]=e,m("provide",!1,t))},start:function(){var e=this;f&&(p||null!=r&&r.onReady(function(){m("start",p=!0),h.forEach(function(t){return e.build(t)}),h=[]}))},report:function(t){t&&(!(t=q(l.beforeReport)(t))||(t=q(l.report)(t))&&(p?this.build(t):h.push(t)))},build:function(t){!p||(t=q(l.beforeBuild)(t))&&(!(t=e.build(t))||(t=q(l.build)(t))&&this.send(t))},send:function(t){!p||(t=q(l.beforeSend)(t))&&(n.send(t),m("send",!1,t))},destroy:function(){m("beforeDestroy",d=!0)},on:function(t,e){"init"===t&&f||"start"===t&&p||"beforeDestroy"===t&&d?e():l[t]&&l[t].push(e)},off:function(t,e){l[t]&&(l[t]=T(l[t],e))}},y=Object.keys(v);return v;function m(t,e){void 0===e&&(e=!1);for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];l[t].forEach(function(t){try{t.apply(void 0,w([],g(n),!1))}catch(t){}}),e&&(l[t].length=0)}}({createDefaultConfig:void 0===(e=e.createDefaultConfig)?Me:e,validateInitConfig:Fe,initConfigNormalizer:qe,builder:void 0===t?ft:t,createSender:void 0===r?function(t){return We({size:pt,endpoint:It(t.reportDomain,t.reportPath),transport:t.transport})}:r,createConfigManager:Ke,userConfigNormalizer:Ue});return W(r),Bt(r),Yt(r),r=H(r),(n=r).on("init",function(){var e=[],t=n.config();t&&t.integrations&&t.integrations.forEach(function(t){P(e,t.name)||(e.push(t.name),t.setup(n),t.tearDown&&n.on("beforeDestroy",t.tearDown))})}),r}var We=l,o=function(t){var e,n,t=Ye(t=void 0===t?{}:t);return Jt(t),Gt(t),Nt(t),(e=t).provide("sendEvent",function(t){t=at(t);t&&e.report({ev_type:ut,payload:t,extra:{timestamp:nt()}})}),e.provide("sendLog",function(t){t=st(t);t&&e.report({ev_type:ut,payload:t,extra:{timestamp:nt()}})}),(n=t).on("start",function(){var t=n.config(),e=t.userId,t=t.sample;t&&0===t.sample_rate&&n.destroy();t=lt(e,t,$,B);n.on("build",t)}),t},r=o();t.BATCH_REPORT_PATH=ht,t.CRASH_DOMAIN=mt,t.CRASH_EV_TYPE="crash",t.CRASH_PATH=gt,t.CRASH_PLUGIN_NAME=Wt,t.CrashMonitorPlugin=Jt,t.DEFAULT_SAMPLE_CONFIG=wt,t.DEFAULT_SAMPLE_GRANULARITY=_t,t.DEFAULT_SENDER_BATCH_SIZE=pt,t.InjectConfigPlugin=Bt,t.InjectEnvPlugin=Yt,t.JS_ERROR_EV_TYPE=Pt,t.JS_ERR_PLUGIN_NAME=jt,t.JsErrorMonitor=Mt,t.JsErrorMonitorPlugin=Nt,t.PC_PERF_PLUGIN_NAME=Ut,t.PcPerfMonitor=$t,t.PcPerfMonitorPlugin=Gt,t.REPORT_DOMAIN=dt,t.SDK_NAME=St,t.SDK_VERSION=bt,t.SETTINGS_DOMAIN=vt,t.SETTINGS_PATH=yt,t.STORAGE_PREFIX=Et,t.Storage=Ne,t.addConfigToReportEvent=zt,t.addEnvToSendEvent=Kt,t.configHolder=ze,t.createContextListener=Vt,t.createElectronClient=o,t.createElectronConfigManager=Ke,t.createMinimalElectronClient=Ye,t.default=r,t.defaultConfig=Ht,t.defaultPlugins=Le,t.electronBuilder=ft,t.getCrashReportUrl=Rt,t.getDefaultConfig=Me,t.getDefaultSessionId=i,t.getDefaultUserIdAndDeviceId=De,t.getPluginConfig=Ot,t.getReportUrl=It,t.getServerConfig=$e,t.getSettingsUrl=ke,t.getStorageKey=Te,t.hasSetStorageItem=je,t.initConfigNormalizer=qe,t.mergeSampleConfig=Be,t.normalizeUserConfig=Ue,t.parseServerConfig=Ge,t.setStorageUserIdAndDeviceId=Pe,t.validateInitConfig=Fe,Object.defineProperty(t,"__esModule",{value:!0})});
