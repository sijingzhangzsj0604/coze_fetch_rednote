"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Cipher=void 0;const Logger_1=require("../../common/Logger"),storage_1=require("../../types/storage"),commonLogger=(0,Logger_1.logger)(),logError=commonLogger.error.bind(commonLogger,"StorageUtilsV2","Cipher");class Cipher{constructor(r){const{cryptoCipherIns:e,systemCipherIns:t}=r;this.cryptoCipher=e,this.systemCipher=t}decrypt(r){var e;const{type:t,content:o=""}=r;let p;try{switch(t){case storage_1.EEncryptionType.System:p=null===(e=this.systemCipher)||void 0===e?void 0:e.decrypt(o);break;case storage_1.EEncryptionType.Crypto:p=this.cryptoCipher.decrypt(o);break;case storage_1.EEncryptionType.Legacy:}}catch(r){logError("decrypt",r)}return p||"{}"}encrypt(r){let e="",t=storage_1.EEncryptionType.Legacy;const o=()=>{try{e=this.cryptoCipher.encrypt(r),t=storage_1.EEncryptionType.Crypto}catch(r){logError("encrypt","cryptoCipher",r)}};if(this.systemCipher)try{e=this.systemCipher.encrypt(r),t=storage_1.EEncryptionType.System}catch(r){logError("encrypt","systemCipher",r),o()}else o();return{content:e,type:t}}}exports.Cipher=Cipher;